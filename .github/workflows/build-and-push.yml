# –§–∞–π–ª: .github/workflows/build-and-push.yml

name: Docker Build and Push (Manual Trigger)

on:
  workflow_dispatch:
    inputs:
      tag:
        description: 'Docker Image Tag (e.g., v1.0.0 or latest)'
        required: true
        default: 'latest'
        type: string

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    
    env:
      DOCKER_IMAGE_NAME: olk005430/santa
      # üîë –ö–†–û–ö 1: –í–∏–∑–Ω–∞—á–∞—î–º–æ –∑–º—ñ–Ω–Ω—É PORT —Ç—É—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 8080)
      PORT: 3001
      
    steps:
    # ... (steps for checkout, login, prepare_tag are unchanged) ...

    # ...
    # ... (–ø—Ä–æ–ø—É—Å–∫ Log in to Docker Hub and Prepare Image Tag)
    # ...

    - name: Build and push Docker image
      uses: docker/build-and-push-action@v5
      with:
        context: .
        push: true
        tags: ${{ steps.prepare_tag.outputs.image_tag }}
        # üîë –ö–†–û–ö 2: –ü–µ—Ä–µ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ PORT —è–∫ Build Argument
        build-args: |
          APP_PORT=${{ env.PORT }} # –°—Ç–≤–æ—Ä—é—î–º–æ ARG –∑ —ñ–º'—è–º APP_PORT, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è env.PORT
